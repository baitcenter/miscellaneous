'use strict'
var Game = function(t, l) {
    var o = void 0,
      e = document.querySelector(t),
      r = e.cloneNode(!1),
      c = e.width,
      n = e.height,
      a = e.getContext('2d'),
      i = 2,
      h = 2,
      f = !0,
      d = 2,
      s = {},
      u = 0,
      g = void 0,
      v = void 0,
      m = function() {
        var t = y()
        ;(s.x = (i * Math.random()) | 0),
          (s.y = (h * Math.random()) | 0),
          (s.w = (c / i++ + 0.5) | 0),
          (s.h = (n / h++ + 0.5) | 0),
          (function(t, e, n) {
            ;(r.width = t), (r.height = e)
            var a = r.getContext('2d'),
              i = 2 * Math.PI
            ;(a.strokeStyle = '#fff'),
              (a.fillStyle = n),
              a.beginPath(),
              a.fillRect(0, 0, t, e),
              a.beginPath(),
              a.strokeRect(0, 0, t, e),
              (a.fillStyle = '#fff'),
              a.beginPath(),
              a.arc(0, 0, 2, 0, i),
              a.arc(t, 0, 2, 0, i),
              a.fill(),
              a.beginPath(),
              a.arc(0, e, 2, 0, i),
              a.arc(t, e, 2, 0, i),
              a.fill()
          })(s.w, s.h, t.color),
          a.beginPath(),
          (v = a.createPattern(r, 'repeat')),
          (a.fillStyle = v),
          a.fillRect(0, 0, c, n),
          a.beginPath(),
          (a.fillStyle = t.color2),
          a.fillRect(s.w * s.x + 3, s.h * s.y + 3, s.w - 6, s.h - 6)
      },
      y = function() {
        var t = {},
          e = [],
          n = void 0
        return (
          (e[0] = (360 * Math.random()) | 0),
          (e[1] = (50 * Math.random()) | 50),
          (e[2] = (90 * Math.random()) | 0),
          (n = e.slice()),
          (e[1] += '%'),
          (e[2] += '%)'),
          (n[2] += n[2] - d < 0 ? d : -d),
          (n[1] += '%'),
          (n[2] += '%)'),
          (t.color = 'hsl(' + e.join(',')),
          (t.color2 = 'hsl(' + n.join(',')),
          (d = Math.max(0.001, d - 0.02)),
          t
        )
      }
    e.addEventListener(
      'click',
      function(t) {
        if (!f) {
          var e = this.getBoundingClientRect(),
            n = c / e.width,
            a = (t.clientX - e.left) * n,
            i = (t.clientY - e.top) * n
          a > s.w * s.x &&
            i > s.h * s.y &&
            a < s.w * (s.x + 1) &&
            i < s.w * (s.y + 1) &&
            (l && l(++u, o), m())
        }
      },
      !1,
    ),
      (this.start = function(t) {
        f &&
          ((f = !1),
          (o = t),
          (d = h = i = 2),
          (u = 0),
          (g = setInterval(function() {
            o < 1 ? ((f = !0), clearInterval(g), l && l(u, 0)) : l && l(u, o--)
          }, 1e3)),
          m())
      })
  },
  span = document.querySelectorAll('span'),
  game = new Game('.stage', function(t, e) {
    ;(span[0].textContent = t),
      (span[1].textContent = e) ||
        alert(
          30 < t
            ? '厉害了我的哥'
            : 20 < t
            ? '还有两把刷子'
            : 10 < t
            ? '一般啦'
            : '跪了把？哈哈哈！！！',
        )
  })
document.querySelector('input').addEventListener(
  'click',
  function() {
    game.start(30)
  },
  !1,
)
